// ---- INIT PAGE ----
// Remove these calls:
// renderProjectDetail(0);
// renderProjectGallery(0);

// ---- Hash-based Project Loader ----
function loadProjectFromHash() {
  const hash = window.location.hash.replace('#', '');
  if (hash) {
    const idx = projects.findIndex(prj => prj.key === hash);
    if (idx !== -1) {
      renderProjectDetail(idx);
      renderProjectGallery(idx);
      return;
    }
  }
  // Default: show first project
  renderProjectDetail(0);
  renderProjectGallery(0);
}
window.addEventListener('hashchange', loadProjectFromHash);
loadProjectFromHash();

// ---- RENDER PROJECT GALLERY ----
function renderProjectGallery(selectedIdx=0) {
  const gallery = document.getElementById('project-gallery-bar');
  gallery.innerHTML = '';
  projects.forEach((prj, idx) => {
    const thumb = document.createElement('div');
    thumb.className = 'project-thumb' + (idx===selectedIdx?' selected':'');
    thumb.tabIndex = 0;
    thumb.innerHTML = `
      <img src="${prj.images[0]}" alt="${prj.title} thumbnail"/>
      <div class="project-thumb-title" style="font-size:0.85em;">${prj.title}</div>
    `;
    thumb.onclick = () => {
      window.location.hash = prj.key;
    };
    thumb.onkeydown = (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        window.location.hash = prj.key;
      }
    };
    gallery.appendChild(thumb);
  });
}